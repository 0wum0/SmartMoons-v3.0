<!DOCTYPE html>
<html lang="{{ lang }}" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
	<title>{% block title %} - {{ uni_name }} - {{ game_name }}{% endblock %}</title>
	<meta name="generator" content="SmartMoons {{ VERSION }}">
	<!-- 
		This website is powered by SmartMoons {{ VERSION }}
		SmartMoons is a modern fork of 2Moons, a free Space Browsergame initially created by Jan Kröpke and licensed under MIT.
		Original 2Moons is copyright 2009-2018 of Jan Kröpke. SmartMoons modernization by 0wum0.
		Information and contribution at https://github.com/0wum0/SmartMoons-v3.0/
	-->
	{% if goto %}
	<meta http-equiv="refresh" content="{{ gotoinsec }};URL={{ goto }}">
	{% endif %}

	<!-- SmartMoons Complete Sci-Fi Redesign Theme -->
	<link rel="stylesheet" type="text/css" href="./styles/theme/smartmoons.css?v={{ REV }}">
	<link rel="stylesheet" type="text/css" href="./styles/resource/css/ingame/main.css?v={{ REV }}">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
	<link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
	
	<script type="text/javascript">
	var ServerTimezoneOffset = {{ Offset }};
	var serverTime 	= new Date({{ date.0 }}, {{ date.1 - 1 }}, {{ date.2 }}, {{ date.3 }}, {{ date.4 }}, {{ date.5 }});
	var startTime	= serverTime.getTime();
	var localTime 	= serverTime;
	var localTS 	= startTime;
	var Gamename	= document.title;
	var Ready		= "{{ LNG.ready }}";
	var Skin		= "{{ dpath }}";
	var Lang		= "{{ lang }}";
	var head_info	= "{{ LNG.fcm_info }}";
	var auth		= {{ authlevel|default("0") }};
	var days 		= {{ LNG.week_day|json_encode|raw|default("[]") }};
	var months 		= {{ LNG.months|json_encode|raw|default("[]") }};
	var tdformat	= "{{ LNG.js_tdformat }}";
	var queryString	= {{ queryString|json_encode|raw }};
	var isPlayerCardActive	= {{ isPlayerCardActive|json_encode|raw }};

	setInterval(function() {
		serverTime.setSeconds(serverTime.getSeconds()+1);
	}, 1000);
	</script>
	
	<script type="text/javascript" src="./scripts/base/jquery.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/base/jquery.ui.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/base/jquery.cookie.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/base/jquery.fancybox.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/base/jquery.validationEngine.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/l18n/validationEngine/jquery.validationEngine-{{ lang }}.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/base/tooltip.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/game/base.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/game/topnav.js?v={{ REV }}"></script>
	{% for scriptname in scripts %}
	<script type="text/javascript" src="./scripts/game/{{ scriptname }}.js?v={{ REV }}"></script>
	{% endfor %}
	{% block script %}{% endblock %}
	<script type="text/javascript">
	$(function() {
		{{ execscript|raw }}
	});
	</script>
</head>

<body id="{{ GET.page|default("overview")|e }}" class="{{ bodyclass }}">
	<div id="tooltip" class="tip"></div>
	
{# === Mobile Burger Button (visible on <= 1024px) === #}
<button id="sm-burger" class="sm-burger sm-only" aria-controls="sm-mobile-drawer" aria-expanded="false" aria-label="Menü öffnen">
  <span class="sm-burger-bar"></span>
  <span class="sm-burger-bar"></span>
  <span class="sm-burger-bar"></span>
</button>

{# === Mobile Drawer + Overlay === #}
<div id="sm-overlay" class="sm-overlay" hidden></div>

<aside id="sm-mobile-drawer" class="sm-drawer" role="dialog" aria-modal="true" aria-labelledby="sm-drawer-title" hidden>
  <div class="sm-drawer-header">
    <h2 id="sm-drawer-title">{{ config.game_name|default('2Moons Universum 1') }}</h2>
    <button class="sm-drawer-close" aria-label="Menü schließen" data-close>×</button>
  </div>

  <nav class="sm-drawer-nav" aria-label="Hauptnavigation">
    <ul class="sm-drawer-list">
      <li><a href="game.php?page=overview">🏠 {{ LNG.lm_overview }}</a></li>

      <li class="sm-section">{{ LNG.lm_empire|default('IMPERIUM') }}</li>
      <li><a href="game.php?page=buildings">🏗️ {{ LNG.lm_buildings }}</a></li>
      <li><a href="game.php?page=research">⚗️ {{ LNG.lm_research }}</a></li>
      <li><a href="game.php?page=shipyard">🚀 {{ LNG.lm_shipyard }}</a></li>
      <li><a href="game.php?page=defense">🛡️ {{ LNG.lm_defense }}</a></li>
      <li><a href="game.php?page=officier">👥 {{ LNG.lm_officiers }}</a></li>

      <li class="sm-section">{{ LNG.lm_fleet|default('FLOTTE & GALAXIE') }}</li>
      <li><a href="game.php?page=fleetTable">✈️ {{ LNG.lm_fleet }}</a></li>
      <li><a href="game.php?page=galaxy">🌐 {{ LNG.lm_galaxy }}</a></li>
      <li><a href="game.php?page=alliance">👪 {{ LNG.lm_alliance }}</a></li>

      <li class="sm-section">{{ LNG.lm_messages|default('NACHRICHTEN') }}</li>
      <li><a href="game.php?page=messages">✉️ {{ LNG.lm_messages }}</a></li>
      <li><a href="game.php?page=buddyList">👥 {{ LNG.lm_buddylist }}</a></li>
      <li><a href="game.php?page=chat">💬 {{ LNG.lm_chat }}</a></li>

      <li class="sm-section">{{ LNG.lm_stats|default('TOOLS & INFO') }}</li>
      <li><a href="game.php?page=statistics">📈 {{ LNG.lm_statistics }}</a></li>
      <li><a href="game.php?page=records">🏆 {{ LNG.lm_records }}</a></li>
      <li><a href="game.php?page=hallOfFame">🥇 {{ LNG.lm_hof }}</a></li>
      <li><a href="game.php?page=battleSimulator">⚔️ {{ LNG.lm_battlesim }}</a></li>
      <li><a href="game.php?page=resources">📦 {{ LNG.lm_resources }}</a></li>
      <li><a href="game.php?page=notes">🗒️ {{ LNG.lm_notes }}</a></li>
      <li><a href="game.php?page=ticket">🆘 {{ LNG.lm_support }}</a></li>
      <li><a href="game.php?page=settings">⚙️ {{ LNG.lm_options }}</a></li>

      {% if USER.authlevel|default(0) >= constant('AUTH_OPS') %}
        <li class="sm-section">ADMIN</li>
        <li><a href="admin.php" rel="nofollow">🛠️ Administration</a></li>
      {% endif %}
    </ul>
  </nav>
</aside>
	
	<!-- SmartMoons Sci-Fi Header -->
	<div id="header">
		<div id="headerTable">
			<!-- Resources Section -->
			{% for resourceID, resourceData in resourceTable %}
			{% if resourceID != 921 %}
			<div class="bar-main-container">
				<div class="wrap">
					<div class="bar-percentage">
						<img src="{{ dpath }}images/{{ resourceData.name }}.gif" alt="{{ LNG.tech[resourceID] }}">
					</div>
					<div class="bar-container">
						<div class="bar bar_{{ resourceID }}" style="width: 0%;"></div>
						<div class="bar-text">
						{% if shortlyNumber %}
							{% if resourceData.current is not defined %}
								{% set currentResource = resourceData.max + resourceData.used %}
								<span class="res_current tooltip" data-tooltip-content="{{ LNG.tech[resourceID] }}: {{ currentResource|number_format }} / {{ resourceData.max|number_format }}">
									<span{% if currentResource < 0 %} class="text-red"{% endif %}>{{ shortly_number(currentResource) }} / {{ shortly_number(resourceData.max) }}</span>
								</span>
							{% else %}
								<span class="res_current tooltip" id="current_{{ resourceData.name }}" data-real="{{ resourceData.current }}" 
									data-tooltip-content="{{ LNG.tech[resourceID] }}: {{ resourceData.current|number_format }} / {{ resourceData.max|number_format }}">
									{{ shortly_number(resourceData.current) }}
								</span>
							{% endif %}
						{% else %}
							{% if resourceData.current is not defined %}
								{% set currentResource = resourceData.max + resourceData.used %}
								<span class="res_current tooltip" data-tooltip-content="{{ LNG.tech[resourceID] }}">
									<span{% if currentResource < 0 %} class="text-red"{% endif %}>{{ currentResource|number_format }} / {{ resourceData.max|number_format }}</span>
								</span>
							{% else %}
								<span class="res_current tooltip" id="current_{{ resourceData.name }}" data-real="{{ resourceData.current }}" 
									data-tooltip-content="{{ LNG.tech[resourceID] }}">
									{{ resourceData.current|number_format }}
								</span>
							{% endif %}
						{% endif %}
						</div>
					</div>
					{% if resourceID != 911 and resourceID != 921 and isModuleAvailable(constant('MODULE_TRADER')) %}
					<div class="bar-change">
						<a href="game.php?page=trader&mode=trade&resource={{ resourceID }}" title="{{ LNG.lm_trader }}">
							<i class="fas fa-exchange-alt"></i>
						</a>
					</div>
					{% endif %}
				</div>
			</div>
			{% else %}
			<!-- Dark Matter Display -->
			<div class="heder_res_921">
				<img src="{{ dpath }}images/{{ resourceData.name }}.gif" alt="{{ LNG.tech[resourceID] }}">
				<span class="res_current res_921_text tooltip" id="current_{{ resourceData.name }}" 
					data-real="{{ resourceData.current }}" 
					data-tooltip-content="{{ LNG.tech[resourceID] }}: {{ resourceData.current|number_format }}">
					{{ shortly_number(resourceData.current) }}
				</span>
			</div>
			{% endif %}
			{% endfor %}

			{% if not vmode %}
			<script type="text/javascript">
			var viewShortlyNumber = {{ shortlyNumber|json_encode }};
			var vacation = {{ vmode }};
			$(function() {
				{% for resourceID, resourceData in resourceTable %}
				{% if resourceData.production is defined %}
				resourceTicker({
					available: {{ resourceData.current|json_encode }},
					limit: [0, {{ resourceData.max|json_encode }}],
					production: {{ resourceData.production|json_encode }},
					valueElem: "current_{{ resourceData.name }}",
					valuePoursent: "bar_{{ resourceID }}"
				}, true);
				{% endif %}
				{% endfor %}
			});
			</script>
			{% endif %}
		</div>
	</div>