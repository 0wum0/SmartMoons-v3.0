<!DOCTYPE html>
<html lang="{{ lang }}" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
	<title>{% block title %} - {{ uni_name }} - {{ game_name }}{% endblock %}</title>
	<meta name="generator" content="SmartMoons {{ VERSION }}">
	
	{% if goto %}
	<meta http-equiv="refresh" content="{{ gotoinsec }};URL={{ goto }}">
	{% endif %}

	<!-- Modern Layout CSS -->
	<link rel="stylesheet" type="text/css" href="./styles/theme/smartmoons.css?v={{ REV }}">
	<link rel="stylesheet" type="text/css" href="./styles/resource/css/ingame/modern-layout.css?v={{ REV }}">
	
	<!-- Font Awesome Icons -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	
	<!-- Google Fonts -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
	
	<link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
	
	<!-- JavaScript Variables -->
	<script type="text/javascript">
	var ServerTimezoneOffset = {{ Offset }};
	var serverTime 	= new Date({{ date.0 }}, {{ date.1 - 1 }}, {{ date.2 }}, {{ date.3 }}, {{ date.4 }}, {{ date.5 }});
	var startTime	= serverTime.getTime();
	var localTime 	= serverTime;
	var localTS 	= startTime;
	var Gamename	= document.title;
	var Ready		= "{{ LNG.ready }}";
	var Skin		= "{{ dpath }}";
	var Lang		= "{{ lang }}";
	var head_info	= "{{ LNG.fcm_info }}";
	var auth		= {{ authlevel|default("0") }};
	var days 		= {{ LNG.week_day|json_encode|raw|default("[]") }};
	var months 		= {{ LNG.months|json_encode|raw|default("[]") }};
	var tdformat	= "{{ LNG.js_tdformat }}";
	var queryString	= {{ queryString|json_encode|raw }};
	var isPlayerCardActive	= {{ isPlayerCardActive|json_encode|raw }};

	setInterval(function() {
		serverTime.setSeconds(serverTime.getSeconds()+1);
	}, 1000);
	</script>
	
	<!-- Core Scripts -->
	<script type="text/javascript" src="./scripts/base/jquery.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/base/jquery.ui.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/base/jquery.cookie.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/base/jquery.fancybox.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/base/jquery.validationEngine.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/l18n/validationEngine/jquery.validationEngine-{{ lang }}.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/base/tooltip.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/game/base.js?v={{ REV }}"></script>
	<script type="text/javascript" src="./scripts/game/modern-layout.js?v={{ REV }}"></script>
	
	{% for scriptname in scripts %}
	<script type="text/javascript" src="./scripts/game/{{ scriptname }}.js?v={{ REV }}"></script>
	{% endfor %}
	
	{% block script %}{% endblock %}
	
	<script type="text/javascript">
	$(function() {
		{{ execscript|raw }}
	});
	</script>
</head>
<body id="{{ GET.page|default("overview")|e }}" class="{{ bodyclass }}">
	<div id="tooltip" class="tip"></div>
	
	<!-- Modern Game Container -->
	<div class="game-container">
		
		<!-- Sticky Header -->
		<header class="game-header">
			<!-- Burger Menu (Mobile) -->
			<button class="burger-menu" aria-label="Toggle Navigation">
				<i class="fas fa-bars"></i>
			</button>
			
			<!-- Logo Section -->
			<div class="header-logo">
				<div class="header-logo-icon">
					<i class="fas fa-rocket"></i>
				</div>
				<div class="header-logo-text">{{ game_name }}</div>
			</div>
			
			<!-- Resource Counters -->
			<div class="header-resources">
				{% for resourceID, resourceData in resourceTable %}
				{% if resourceID != 921 %}
				<div class="resource-item" data-tooltip="{{ LNG.tech[resourceID] }}: {{ resourceData.current|default(resourceData.max + resourceData.used)|number_format }} / {{ resourceData.max|number_format }}">
					<img src="{{ dpath }}images/{{ resourceData.name }}.gif" alt="{{ LNG.tech[resourceID] }}" class="resource-icon">
					<span class="resource-value" id="current_{{ resourceData.name }}" data-real="{{ resourceData.current|default(resourceData.max + resourceData.used) }}">
						{% if shortlyNumber %}
							{{ shortly_number(resourceData.current|default(resourceData.max + resourceData.used)) }}
						{% else %}
							{{ resourceData.current|default(resourceData.max + resourceData.used)|number_format }}
						{% endif %}
					</span>
				</div>
				{% else %}
				<!-- Dark Matter -->
				<div class="resource-item resource-dm" data-tooltip="{{ LNG.tech[resourceID] }}: {{ resourceData.current|number_format }}">
					<img src="{{ dpath }}images/{{ resourceData.name }}.gif" alt="{{ LNG.tech[resourceID] }}" class="resource-icon">
					<span class="resource-value text-purple" id="current_{{ resourceData.name }}" data-real="{{ resourceData.current }}">
						{{ shortly_number(resourceData.current) }}
					</span>
				</div>
				{% endif %}
				{% endfor %}
			</div>
		</header>
		
		<!-- Sidebar Navigation -->
		<aside class="game-sidebar" id="sidebar">
			<div class="sidebar-content">
				<!-- Overview Section -->
				<div class="nav-section">
					<div class="nav-section-title">{{ LNG.lm_overview }}</div>
					<a href="game.php?page=overview" class="sidebar-link{% if GET.page|default('overview') == 'overview' %} active{% endif %}">
						<i class="fas fa-home"></i>
						<span>{{ LNG.lm_overview }}</span>
					</a>
				</div>
				
				<!-- Empire Section -->
				<div class="nav-section">
					<div class="nav-section-title">{{ LNG.lm_empire }}</div>
					
					{% if isModuleAvailable(constant('MODULE_BUILDING')) %}
					<a href="game.php?page=buildings" class="sidebar-link{% if GET.page|default('') == 'buildings' %} active{% endif %}">
						<i class="fas fa-city"></i>
						<span>{{ LNG.lm_buildings }}</span>
					</a>
					{% endif %}
					
					{% if isModuleAvailable(constant('MODULE_RESEARCH')) %}
					<a href="game.php?page=research" class="sidebar-link{% if GET.page|default('') == 'research' %} active{% endif %}">
						<i class="fas fa-flask"></i>
						<span>{{ LNG.lm_research }}</span>
					</a>
					{% endif %}
					
					{% if isModuleAvailable(constant('MODULE_SHIPYARD_FLEET')) %}
					<a href="game.php?page=shipyard&mode=fleet" class="sidebar-link{% if GET.page|default('') == 'shipyard' and GET.mode|default('') == 'fleet' %} active{% endif %}">
						<i class="fas fa-rocket"></i>
						<span>{{ LNG.lm_shipshard }}</span>
					</a>
					{% endif %}
					
					{% if isModuleAvailable(constant('MODULE_SHIPYARD_DEFENSIVE')) %}
					<a href="game.php?page=shipyard&mode=defense" class="sidebar-link{% if GET.page|default('') == 'shipyard' and GET.mode|default('') == 'defense' %} active{% endif %}">
						<i class="fas fa-shield-alt"></i>
						<span>{{ LNG.lm_defenses }}</span>
					</a>
					{% endif %}
					
					{% if isModuleAvailable(constant('MODULE_OFFICIER')) or isModuleAvailable(constant('MODULE_DMEXTRAS')) %}
					<a href="game.php?page=officier" class="sidebar-link{% if GET.page|default('') == 'officier' %} active{% endif %}">
						<i class="fas fa-user-tie"></i>
						<span>{{ LNG.lm_officiers }}</span>
					</a>
					{% endif %}
				</div>
				
				<!-- Navigation Section -->
				<div class="nav-section">
					<div class="nav-section-title">{{ LNG.lm_navigation }}</div>
					
					{% if isModuleAvailable(constant('MODULE_FLEET_TRADER')) %}
					<a href="game.php?page=fleetTable" class="sidebar-link{% if GET.page|default('') == 'fleetTable' %} active{% endif %}">
						<i class="fas fa-space-shuttle"></i>
						<span>{{ LNG.lm_fleet }}</span>
					</a>
					{% endif %}
					
					{% if isModuleAvailable(constant('MODULE_GALAXY')) %}
					<a href="game.php?page=galaxy" class="sidebar-link{% if GET.page|default('') == 'galaxy' %} active{% endif %}">
						<i class="fas fa-globe"></i>
						<span>{{ LNG.lm_galaxy }}</span>
					</a>
					{% endif %}
					
					{% if isModuleAvailable(constant('MODULE_ALLIANCE')) %}
					<a href="game.php?page=alliance" class="sidebar-link{% if GET.page|default('') == 'alliance' %} active{% endif %}">
						<i class="fas fa-users"></i>
						<span>{{ LNG.lm_alliance }}</span>
					</a>
					{% endif %}
					
					{% if isModuleAvailable(constant('MODULE_MESSAGES')) %}
					<a href="game.php?page=messages" class="sidebar-link{% if GET.page|default('') == 'messages' %} active{% endif %}">
						<i class="fas fa-envelope"></i>
						<span>{{ LNG.lm_messages }}</span>
						{% if new_message > 0 %}
						<span class="badge">{{ new_message > 99 ? '99+' : new_message }}</span>
						{% endif %}
					</a>
					{% endif %}
					
					{% if isModuleAvailable(constant('MODULE_STATISTICS')) %}
					<a href="game.php?page=statistics" class="sidebar-link{% if GET.page|default('') == 'statistics' %} active{% endif %}">
						<i class="fas fa-chart-line"></i>
						<span>{{ LNG.lm_statistics }}</span>
					</a>
					{% endif %}
				</div>
				
				<!-- Tools Section -->
				<div class="nav-section">
					<div class="nav-section-title">{{ LNG.lm_tools }}</div>
					
					{% if isModuleAvailable(constant('MODULE_SIMULATOR')) %}
					<a href="game.php?page=battleSimulator" class="sidebar-link{% if GET.page|default('') == 'battleSimulator' %} active{% endif %}">
						<i class="fas fa-crosshairs"></i>
						<span>{{ LNG.lm_battlesim }}</span>
					</a>
					{% endif %}
					
					{% if isModuleAvailable(constant('MODULE_RESSOURCE_LIST')) %}
					<a href="game.php?page=resources" class="sidebar-link{% if GET.page|default('') == 'resources' %} active{% endif %}">
						<i class="fas fa-chart-bar"></i>
						<span>{{ LNG.lm_resources }}</span>
					</a>
					{% endif %}
					
					{% if isModuleAvailable(constant('MODULE_NOTICE')) %}
					<a href="javascript:OpenPopup('?page=notes', 'notes', 720, 300);" class="sidebar-link">
						<i class="fas fa-sticky-note"></i>
						<span>{{ LNG.lm_notes }}</span>
					</a>
					{% endif %}
					
					{% if isModuleAvailable(constant('MODULE_SUPPORT')) %}
					<a href="game.php?page=ticket" class="sidebar-link{% if GET.page|default('') == 'ticket' %} active{% endif %}">
						<i class="fas fa-headset"></i>
						<span>{{ LNG.lm_support }}</span>
					</a>
					{% endif %}
					
					<a href="game.php?page=settings" class="sidebar-link{% if GET.page|default('') == 'settings' %} active{% endif %}">
						<i class="fas fa-cog"></i>
						<span>{{ LNG.lm_options }}</span>
					</a>
					
					<a href="game.php?page=logout" class="sidebar-link">
						<i class="fas fa-sign-out-alt"></i>
						<span>{{ LNG.lm_logout }}</span>
					</a>
				</div>
				
				<!-- Admin Section -->
				{% if authlevel > 0 %}
				<div class="nav-section">
					<div class="nav-section-title">{{ LNG.lm_administration }}</div>
					<a href="./admin.php" class="sidebar-link admin-link" target="_blank">
						<i class="fas fa-user-shield"></i>
						<span>{{ LNG.lm_administration }}</span>
					</a>
				</div>
				{% endif %}
			</div>
		</aside>
		
		<!-- Mobile Overlay -->
		<div class="sidebar-overlay"></div>
		
		<!-- Main Content Area -->
		<main class="game-main">
			{% if hasAdminAccess %}
			<div class="game-card mb-3">
				<div class="card-body bg-yellow">
					<div class="flex items-center gap-3">
						<i class="fas fa-exclamation-triangle text-yellow"></i>
						<span>{{ LNG.admin_access_1 }} <a id="drop-admin" href="#" class="text-cyan">{{ LNG.admin_access_link }}</a>{{ LNG.admin_access_2 }}</span>
					</div>
				</div>
			</div>
			{% endif %}
			
			<div class="content-container">
				{% block content %}{% endblock %}
			</div>
		</main>
	</div>
	
	<!-- Resource Ticker Script -->
	{% if not vmode %}
	<script type="text/javascript">
	var viewShortlyNumber = {{ shortlyNumber|json_encode }};
	var vacation = {{ vmode }};
	$(function() {
		{% for resourceID, resourceData in resourceTable %}
		{% if resourceData.production is defined %}
		resourceTicker({
			available: {{ resourceData.current|json_encode }},
			limit: [0, {{ resourceData.max|json_encode }}],
			production: {{ resourceData.production|json_encode }},
			valueElem: "current_{{ resourceData.name }}"
		}, true);
		{% endif %}
		{% endfor %}
	});
	</script>
	{% endif %}
	
	<!-- Cronjobs -->
	{% for cronjob in cronjobs %}<img src="cronjob.php?cronjobID={{ cronjob }}" alt="" style="display:none;">{% endfor %}
	
	<!-- Google Analytics -->
	{% if ga_active %}
	<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', '{{ ga_key }}']);
	_gaq.push(['_trackPageview']);
	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
	</script>
	{% endif %}
	
	{% if debug == 1 %}
	<script type="text/javascript">
	onerror = handleErr;
	</script>
	{% endif %}
</body>
</html>